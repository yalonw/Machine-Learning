日月光華 -- Virus精華區文章閱讀
--------------------------------------------------------------------------------
 發信人: Hyoga (白鳥座·冰河), 信區: Virus
標  題: Windows出錯信息解析及解決方案
發信站: 日月光華 (2003年01月06日13:46:49 星期一), 站內信件


                       Windows出錯信息解析及解決方案
 
-----------------------------------------------------------------------------

                        整理：阿新（Seraph Chutium）


　　註冊表錯誤
　　Windows 9x/Me/NT/2000把系統的許多設置都組織起來，放到了註冊表中，這樣雖然
易於管理一些（不用像在DOS和Windows 3.x時面對無窮的.ini文件）。可是同時也帶來
了這樣的問題:如果哪個安裝程序的反安裝做得不好，很容易在註冊表中留下一些垃圾。
你留一些、我留一些，隨著時間的流逝，安裝/刪除程序的增加，註冊表的體積也在突飛
猛進，系統當然也慢慢變慢;更有甚者，有些軟件如果破壞了註冊表，輕則使你不能使用
部分軟件，重則系統不能啟動，慘……
　　當你的系統啟動很慢或者你安裝/刪除了很多軟件時，你應該用註冊表清理工具來清
理一下註冊表垃圾了，千萬不要等到Windows告訴你“註冊表錯誤” 之類的信息之後，
你才手忙腳亂地到處打電話，請教朋友……

　　Regcleaner
　　發佈公司:Jouni Vuorio
　　最新版本:4.1a
　　下載網址: ftp://ftp.download.com.cn/pub/new_system/RegCleaner.exe
　　這是一個註冊表清理工具：RegCleaner。它是免費的，不過功能稍嫌單薄，只能清
理註冊表中多餘的註冊表項，不能修復錯誤。
　　案例:你用的是Win9x，某一天你發現了再也不能進入Windows，總是顯示一些註冊表
錯誤之類的信息然後就死機或者重新啟動，怎麼辦呢？
　　解決方案:首先想到的第一招應該是——使用Windows註冊表備份修復，方法嘛？很
簡單:
　　啟動到DOS下，執行Scanreg /restore，在彈出的“Microsoft Registry Checker”
窗口中，你可以看到五個文件，文件名分別為rb000.cab、rb002.cab……rb004.cab，找
一個時間離現在最近的，選擇“Restore”，系統應該可以正常啟動了。如果還是不行，
可以重新運行Scanreg，選擇一個時間稍微再早一點的，再試……
　　注意:現在市面上有很多註冊表方面的書，通過修改註冊表來提升系統性能和個性化
設置更是大家都很熟悉的事情，可是要記得一點——備份，強烈建議你在每次修改註冊
表的時候都將你的註冊表備份一次！


　　動態鏈接庫出錯 
　　我們大家都知道，DLL是Windows中很重要的一種文件，不過微軟開始採用這種動態
鏈接庫的時候卻沒有想到動態鏈接庫也會有同名的時候，這些同名的文件可能是因為版
本不同而內容不一樣、也可能是完全不相干的兩個（只不過名字相同），當同名的這些
文件被覆蓋之後，引起的後果就是災難性——或者應用程序無法運行、或者程序老是出
錯，嚴重的系統根本無法啟動。
　　說到這裡我們不能不提到VxD錯誤，VxD是虛擬設備，如果這些文件被替換的話，會
導致和上邊同樣的災難性後果。
　　案例一:我每次啟動計算機的時候，總是會出現如下的出錯提示，但是按下回車鍵進
入系統過後一切都可以使用，並且系統沒有什麼異常，這是什麼原因？
　　解決方案:看你的情形，應該不是因為缺少VxD文件所致，這種情況一般是因為不良
的安裝程序引起的，當你用它的反安裝程序時，相應的文件雖然被刪除了，但是卻在注
冊表中留下了些殘骸。
　　運行註冊表編輯器Regedit.exe打開註冊表，按下“Ctrl+F”查找相應的文件名，找
到以後將該註冊表項刪除，重新啟動，問題應該解決了^_^。
　　注意:其實上述情況的發生，還有更可能的一種原因——那就是你採用很強暴的方式
刪除應用程序（直接將應用程序安裝目錄刪除）時也可能產生這種問題，強烈建議你採
用應用程序自帶的“反安裝程序”來完成應用程序的反安裝。

　　案例二:在一次狂刪軟件中我卸載了某個軟件，提示說還有c:\windows\system\WSoc
k32.dll沒刪掉。重新啟動後與上網有關的所有程序（IE、OE、Netants等）都無法運行，
提示說:“系統出錯，無法啟動文件WSock32.dll。請檢查文件，確定出問題的原因。”
不知WSock32.dll是windows的什麼重要文件，我該怎麼解決？
　　解決方案:這種問題是典型的Dll文件被覆蓋所產生的，從IE、OE等出錯，說明是系
統文件遭到破壞引起的，同時你也知道了遭破壞的文件WSock32.dll，不妨從Windows安
裝盤釋放一個WSock32.dll到提示目錄即可（c:\windows\system下），但是為了保險起
見，最好先將原來的WSock32.dll備份。
　　注意:要覆蓋文件，請一定注意Dll文件或者VxD文件的版本號要和你的Windows匹配
，如果你不知道怎麼才是匹配，請將你的Windows安裝盤放入光驅，然後運行sfc.exe讓
Windows自動檢測被破壞的系統文件吧！
　　在Windows光盤上單擊右鍵，選擇“查找”，在彈出的“查找”窗口中，填寫“包含
文字”欄為需要查找的文件名（這裡是WSock32.dll），按下“開始查找”，等光盤燈不
亮的時候，可以看到在右邊的查找到文件窗口中有一個Precopy2.cab（不同的Windows版
本文件名也是不同的）。用Winzip將其中的WSock32.dll解壓縮到需要的目錄，至此大功
告成（如果你沒有Winzip，也可以使用Windows自帶的Extract來釋放文件，具體用法這
裡就不再贅述）。
　　注意:Dll和VxD文件很容易出現被覆蓋的現象，所以當安裝應用程序的時候提示“xx
xx 文件將被覆蓋，是保留老版本文件還是替換”，你一定要謹慎行事，最好不要替換，
這樣可以保證已經安裝的軟件和系統的正常運行。


　　程序失去反應
　　身在Windows下，某個應用程序失去反應可能是最常見的事情。如果不是在系統啟動
的時候某個程序失去了反應，你應該首先等待一下，一般會解決大部分問題（這主要是
該應用程序正在忙於處理，來不及向系統發去的信號反應，等一段時間就是等應用程序
處理完畢，你也不要太性急了……）;還是不行的話，建議你啟動一下計算機——Window
s過一段時間要重新啟動早已經是解決Windows問題屢試不爽的妙訣了……
　　不過，要是你在安裝某個應用程序、新加設備，而且重新啟動之後卻發現應用程序
失去發應，只怕事情就不是那麼簡單的了。
　　案例:最近，我的電腦遇到了問題，每次一開機，剛剛出現桌面背景，連屏幕下的任
務欄還沒有就會出現一個對話框，左上角有“mprexe”字樣，內容為“該程序執行了非
法作，即將關閉，請予供應商聯繫”有時點關閉後照樣能正常啟動，有時就停止不動只
能重新啟動。即使覆蓋重裝了Win98也不管用。
　　解決方案:MPR出錯一般是因為用戶口令文件出錯、服務衝突和正在用戶配置文件、
硬件衝突、硬件驅動程序出錯等等。
　　1.用戶口令文件出錯
　　我們可以通過重建用戶口令文件來糾正錯誤。按下“Win+F”打開查找窗口，在“文
件名”欄中輸入“*.pwl”，按下“開始查找”，在查找到的文件窗口中，將所有文件更
名或者刪除。重新啟動Windows，在出現登錄窗口時，重新輸入用戶名和口令就可以了…
… 
　　2.服務/應用程序衝突
　　要解決服務和應用程序衝突，你需要以“安全模式”啟動計算機。然後將剛才安裝
的應用程序反安裝或者服務禁用，看看是否可以解決問題。
　　3.用戶配置文件問題
　　這可以通過禁止用戶配置文件來解決此類錯誤。
　　在“網上鄰居”上單擊“右鍵”，選擇“屬性”，在“訪問控制”中選擇“共享級
訪問控制”，確定退出後重新啟動。
　　4.硬件衝突
　　你可以在設備管理器中通過將有問題的硬件禁用來找到硬件衝突。
　　打開“控制面板”/“系統”/“設備管理器”，在有黃色驚歎號（或問號）的設備
上雙擊，選擇“該設備在當前配置文件中禁用”，重複上述步驟可以找到真正有衝突的
硬件，請更換它。
　　5.設備驅動程序損壞
　　請重新安裝該設備的驅動程序。
　　注:MPrexe失去反應可能是我們最常遇到的程序失去反應案例，這種案例的情形十分
複雜，上述並不能完全包括，如果你的英文夠好，請參閱微軟的MPrexe問題詳盡介紹: 
http://support.microsoft.com/support/kb/articles/Q178/0/84.asp。


　　Windows NT/2000一般錯誤
　　Windows NT/2000是Windows系列的服務器家族重要成員，穩定性比Win9x有了很大的
改進，不過他也並不是不會出錯，好在是WinNT/2000的出錯信息有詳細的記錄，我們可
以通過“事件查看器”來找到出問題的原因進而找出解決方案。
　　我們這裡說的一般錯誤，是指的Windows NT/2000還可以運行，不過會彈出出錯信息
，那種導致直接當機的問題請參看“Windows NT/2000 STOP錯誤”。
　　案例:我啟動Win2000的時候，彈出一個錯誤窗口“At least one service or 
driver failed during system startup. Use Event Viewer to examine the event 
log for details”，請問這種問題該如何解決？
　　解決方案:很簡單，Windows不是提醒你用“Event Viewer（事件查看器）”來了解
一下詳情嗎？
　　打開“事件查看器”，在下圖的窗口中，我們可以看到一個前面標有“×”的錯誤
信息，雙擊查看該出錯信息的詳細出錯信息。
　　在彈出的出錯信息描述中，我們可以看到是這樣描述的“The messenger service 
terminated with service-specific error 2270.”，記下出錯信息2270，現在打開一
個命令行窗口，輸入“net helpmsg 2270”，現在你應該看到出錯信息了。
　　“The computer name could not be added as a message alias. The name may 
already exist on the network. ”
　　這說明現在這臺電腦的Message Alias（消息別名）已經在網絡上註冊了（你將收不
到用net send MessageAlias Message發過來的短信息了），請另外給本臺電腦命名就可
以了。


　　Windows NT/2000 STOP錯誤
　　Stop錯誤是Windows NT/2000系列特有的一種錯誤，和Windows NT/2000普通錯誤不
同的是——出現了該種錯誤以後，如果電腦繼續執行下去，可能會破壞數據，因此Windo
ws NT/2000會顯示一條STOP:0x0000000A之類的錯誤，然後藍屏，停機……
　　案例:我用的是Win2000，可是有一天啟動的時候卻突然出現瞭如下圖的“STOP:0x00
00007B”的藍屏，然後計算機就停止了反應，請問我該怎麼解決這種問題？
　　解決方案:碰到這種問題，一般可以按照以下方式解決。
　　1.首先使用新版殺毒軟件檢查計算機上是否有病毒。
　　2.如果Windows NT/2000仍然可以啟動，請檢查“事件查看器”中的信息，以確定導
致故障的設備或驅動程序。具體解決步驟請參考上邊“Windows NT/2000一般錯誤”。
　　3.如果不能啟動計算機，試著用“安全模式”或“最後一次正確的配置”啟動計算
機，然後刪除或禁用新安裝的附加程序或驅動程序。如果用“安全模式”啟動不了計算
機，可以考慮使用修復控制檯，修復控制檯可以在Console模式下禁用一些服務、重新命
名設備驅動程序、檢修引導扇區或主引導記錄（詳細步驟請參考相應資料，這個需要比
較專業的知識，這裡不便詳述）。
　　4.拆下新安裝的硬件設備（RAM、適配卡、硬盤、調制解調器等等），看看是否可以
正常啟動（如果你新安裝了硬盤導致盤符錯位，可是會引起上述問題的）。
　　5.確保已經更新了硬件設備的驅動程序，以及系統有最新的BIOS。
　　6.運行由計算機製造商提供的系統診斷工具，尤其是內存檢查。
　　7.檢查Microsoft兼容硬件列表（HCL），確保所有的硬件和驅動程序都與Windows 
2000兼容。Hcl.txt在Windows 2000 CD-ROM的Support文件夾中，你也可以到微軟的網站
查看http://www.microsoft.com/hcl/default.asp。
　　8.在BIOS中禁用內存緩存。
　　9.重新啟動計算機，在啟動菜單處，按F8進入“高級啟動選項”，選擇“最後一次
正確的配置”。（注:使用“最後一次正確的配置”的方式啟動計算機後，計算機的所有
設置被重置為最後一次正確啟動時的配置。）
　　10.如果能夠訪問Web，請進入 http://www.microsoft.com/，單擊“Support”/“
Search Microsoft.com”，在“Search for:”處，輸入“stop”和相應的號碼（如出現
STOP消息“stop:0x0000007B”，可在此輸入“stop:0x0000007B”），按Enter鍵，（上
接70頁）
　　就可以找出所出現的STOP問題的解決方法。
　　注:其實上邊的Windows NT/2000一般問題的解決也可以在微軟的站點上查找到詳盡
的幫助信息，出問題的時候你直接的想法應該是去看看微軟的技術支持站點——看看他
是怎麼說的（上邊的STOP:0x0000007B錯誤經查，原來是服務器上新添加了硬盤，但是沒
有注意到磁盤的主從順序導致的）。


　　Windows的出錯信息是難以窮盡的，我上邊所列的Windows錯誤可能也只是管中窺豹
，不過我們的用意也不在於要將所有的出錯信息列舉出來，只是想通過這樣的介紹給你
一種解決問題的思路，使你在Windows出錯的時候不至於手忙腳亂…… 
  
--
※ 來源:·日月光華 bbs.fudan.edu.cn·[FROM: 10.85.32.100]
※ 修改:·Hyoga 於 01月06日13:49:55 修改本文·[FROM: 10.85.32.100]

 

--------------------------------------------------------------------------------
[返回上一頁] [本討論區]